#include "TComplex.h"
#include <vector>
#include <TVector3.h>

#define nCentBin 14
#define nHarmonics 8
#define nPtBin 19 

using namespace std;
using namespace reco;
using namespace edm;

  bool useReDenominator = true;
  bool useRe = true;
  double cBin[nCentBin+1]={0,5,10,15,20,25,30,35,40,50,60,70,80,90,100};
  double ptBin[nPtBin+1]={0.3, 0.4, 0.5, 0.6, 0.8, 1.0, 1.2, 1.6, 2.0, 2.5, 3.0, 3.5, 4.0, 5.0, 6.0, 8.0, 10.0, 12.0, 16.0, 22.0};
  TComplex QhfPlus[nCentBin][nHarmonics];
  TComplex QhfMinus[nCentBin][nHarmonics];
  //TComplex QtrkPlus[nCentBin][nHarmonics];
  //TComplex QtrkMinus[nCentBin][nHarmonics];
  double VnAbs2[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs4[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs6[nCentBin][nHarmonics]={{0.0},{0.0}};
  double V2Abs2V3Abs2[nCentBin]={0.0};
  double V2Abs4V3Abs2[nCentBin]={0.0};
  double V4V2starV2star[nCentBin]={0.0};
  double V6V2starV2starV2star[nCentBin]={0.0};
  double V6V3starV3star[nCentBin]={0.0};
  double V5V2starV3star[nCentBin]={0.0};
  double V7V2starV2starV3star[nCentBin]={0.0};
  double v2Psi2[nCentBin]={0.0};
  double v3Psi3[nCentBin]={0.0};
  double v4Psi2[nCentBin]={0.0};
  double v4Psi4[nCentBin]={0.0};
  double v6Psi2[nCentBin]={0.0};
  double v6Psi3[nCentBin]={0.0};
  double v6Psi6[nCentBin]={0.0};
  double v5Psi2Psi3[nCentBin]={0.0};
  double v7Psi2Psi3[nCentBin]={0.0};
  int nEvent[nCentBin]={0};

  vector<TVector3> *pVect_trkEtaPlus;
  vector<TVector3> *pVect_trkEtaMinus;  
  vector<TVector3> *pVect_hfEtaPlus;
  vector<TVector3> *pVect_hfEtaMinus;  

  TH1D* hMultTrkEtaPlus;
  TH1D* hMultTrkEtaMinus;
  TH1D* hMultHFEtaPlus;
  TH1D* hMultHFEtaMinus;
  TH1D* hQhfPlusX[nCentBin][nHarmonics];
  TH1D* hQhfPlusY[nCentBin][nHarmonics];
  TH1D* hQhfPlusQ[nCentBin][nHarmonics];
  TH1D* hQhfMinusX[nCentBin][nHarmonics];
  TH1D* hQhfMinusY[nCentBin][nHarmonics];
  TH1D* hQhfMinusQ[nCentBin][nHarmonics];
  TH1D* hVnAbs2[nCentBin][nHarmonics];
  TH1D* hVnAbs4[nCentBin][nHarmonics];
  TH1D* hVnAbs6[nCentBin][nHarmonics];
  TH1D* hVnAbs8[nCentBin][nHarmonics];
  TH1D* hV2Abs2V3Abs2[nCentBin];
  TH1D* hV2Abs4V3Abs2[nCentBin];
  TH1D* hV2Abs2V3Abs4[nCentBin];


  TH1D* hV2V2star[nCentBin];
  TH1D* hV4V2starV2star[nCentBin];
  TH1D* hV6V2starV2starV2star[nCentBin];
  TH1D* hV6V3starV3star[nCentBin];
  TH1D* hV5V2starV3star[nCentBin];
  TH1D* hV7V2starV2starV3star[nCentBin];

  TH1D* hv2V2star[nCentBin][nPtBin];
  TH1D* hv3V3star[nCentBin][nPtBin];
  TH1D* hv4V4star[nCentBin][nPtBin];
  TH1D* hv5V5star[nCentBin][nPtBin];
  TH1D* hv6V6star[nCentBin][nPtBin];
  TH1D* hv7V7star[nCentBin][nPtBin];
  TH1D* hv8V8star[nCentBin][nPtBin];
  TH1D* hv4V2starV2star[nCentBin][nPtBin];
  TH1D* hv6V2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv6V3starV3star[nCentBin][nPtBin];
  TH1D* hv5V2starV3star[nCentBin][nPtBin];
  TH1D* hv7V2starV2starV3star[nCentBin][nPtBin];
  TH1D* hv8V2starV2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv8V2starV3starV3star[nCentBin][nPtBin];

  TH1D* hMeanPt[nCentBin][nPtBin];


   TH1D* hCent;
   TH1D* hHF;
   TH1D* hAngle;
   TH1D* hAngleFlat;
   TH1D* hvz;
   TH1D* hvx;
   TH1D* hvy;
   TH1D* hNtrks;
   TH1D* hpt;
   TH1D* heta;
   TH1D* hphi;
   TH1D* hHFcal;



double meanQxPlus[nCentBin][nHarmonics] = {{0.00198234, -0.0040696, 0.000246629, -0.000893702, 0.000967239, -0.00147524, 0.000922883, -0.00401634}, 
{0.00186277, -0.00403669, 0.000289033, -0.00106111, 0.00102638, -0.00141532, 0.000924564, -0.00402784}, 
{0.00169982, -0.00397491, 0.000369307, -0.00111994, 0.00107035, -0.00138261, 0.000938639, -0.00404544}, 
{0.00161314, -0.00412902, 0.000374418, -0.00124266, 0.0010666, -0.00133113, 0.000948054, -0.00398946}, 
{0.00145841, -0.00422404, 0.000400218, -0.00128476, 0.00111545, -0.00132742, 0.00091994, -0.00397552}, 
{0.00130904, -0.0040016, 0.000444123, -0.00135229, 0.00110159, -0.00136285, 0.00092009, -0.00395932}, 
{0.0011625, -0.00417991, 0.000413301, -0.00143272, 0.00109435, -0.00138101, 0.000890809, -0.00394286}, 
{0.000947495, -0.0039722, 0.000435537, -0.00145082, 0.000998689, -0.00131937, 0.000855241, -0.00386285}, 
{0.000667403, -0.00391352, 0.000383032, -0.00153474, 0.00110258, -0.00132841, 0.00084575, -0.00377982}, 
{0.000194521, -0.00380181, 0.000452282, -0.00167014, 0.000999102, -0.00127289, 0.000898858, -0.00363141}, 
{-0.00111274, -0.00336704, 0.000638882, -0.00189986, 0.000838712, -0.00104238, 0.000905584, -0.00340355}, 
{-0.0040715, -0.00219217, 0.000988769, -0.00277473, 0.000533377, -0.000538228, 0.000808842, -0.00274218}, 
{-0.0119281, 0.000749427, 0.00220148, -0.00468709, -7.53318e-05, 0.00080277, 0.000876619, -0.000629177}, 
{-0.0305615, 0.00880806, 0.0053157, -0.00962406, -0.00188448, 0.00405722, 0.000728442, 0.00471126}}; 
double meanQyPlus[nCentBin][nHarmonics] = {{0.000961875, 0.000537683, 0.00530771, -0.00375831, 0.000508167, 0.00198492, -0.000684256, 0.00110025}, 
{0.00107832, 0.00053877, 0.00528463, -0.00380399, 0.000411302, 0.00200889, -0.000750533, 0.000988152}, 
{0.00114285, 0.000609208, 0.00526087, -0.003771, 0.000393989, 0.00210315, -0.000813267, 0.000913466}, 
{0.00118474, 0.000653356, 0.00517401, -0.00378885, 0.000302474, 0.00213125, -0.000871427, 0.000816457}, 
{0.00127639, 0.000642653, 0.0051361, -0.00380498, 0.000265048, 0.00211303, -0.000887951, 0.000711689}, 
{0.00127767, 0.000639989, 0.00514645, -0.00380835, 0.000199798, 0.00210162, -0.000978244, 0.000676155}, 
{0.00141812, 0.000824141, 0.0050415, -0.00376672, 0.00019393, 0.00212821, -0.00105391, 0.000630169}, 
{0.00142593, 0.0010589, 0.0049553, -0.00379889, 6.80971e-05, 0.00209357, -0.00111784, 0.000579252}, 
{0.00163378, 0.000987905, 0.00493994, -0.00376615, 3.94296e-05, 0.00200448, -0.00109794, 0.000529032}, 
{0.00194237, 0.00119767, 0.00465531, -0.00371862, -8.77553e-05, 0.00184288, -0.00108062, 0.000331333}, 
{0.00271649, 0.00160184, 0.00413096, -0.00348603, -0.000377509, 0.00124875, -0.000929126, -0.000153525}, 
{0.00468857, 0.00305649, 0.00250133, -0.00251841, -0.00114252, -0.000247718, -0.000624941, -0.00129473}, 
{0.00955007, 0.00697455, -0.00142381, 0.00025969, -0.00318565, -0.00419319, 9.40533e-06, -0.00490956}, 
{0.0211034, 0.0164476, -0.0122229, 0.00691467, -0.00824989, -0.0138998, 0.00183028, -0.0134167}}; 
double meanQxMinus[nCentBin][nHarmonics] = {{-0.00743503, -0.00334901, -3.96988e-06, 1.58528e-05, -0.000210306, -0.000379034, 0.00285443, 0.00246619}, 
{-0.00744855, -0.00333521, -5.12367e-05, 5.66172e-05, -0.000217946, -0.000374151, 0.00283843, 0.00245403}, 
{-0.00741979, -0.00333518, 4.7411e-05, 8.75918e-05, -0.000223217, -0.000421078, 0.00282877, 0.00241109}, 
{-0.00734597, -0.00346063, 5.59799e-05, 0.000133548, -0.00018914, -0.000373378, 0.00274511, 0.00240791}, 
{-0.0073894, -0.00356714, 0.000112498, 8.79227e-05, -0.00019896, -0.000400783, 0.00272662, 0.00235458}, 
{-0.00725691, -0.0034566, 7.35098e-05, 6.00818e-05, -0.000204996, -0.000409464, 0.00260591, 0.0023422}, 
{-0.00728092, -0.00368432, 9.85462e-06, 2.21485e-05, -0.000168191, -0.000371395, 0.00254131, 0.00233311}, 
{-0.00726158, -0.00356557, -9.29828e-06, -9.60363e-05, -0.000178804, -0.00045055, 0.00241925, 0.00228178}, 
{-0.00718867, -0.00363151, -0.000120951, -0.000210419, -0.000203454, -0.0004567, 0.00224096, 0.00228977}, 
{-0.0069587, -0.00372603, -0.000235141, -0.00031789, -0.000221453, -0.000555087, 0.00203386, 0.00223127}, 
{-0.00675275, -0.00377807, -0.000490234, -0.000501815, -0.000140081, -0.000697676, 0.00154142, 0.00208436}, 
{-0.00622077, -0.00374178, -0.00111198, -0.000813105, 6.67505e-05, -0.00120312, 3.61801e-05, 0.00171145}, 
{-0.00454716, -0.00415199, -0.00234471, -0.00218335, 0.000645042, -0.00289726, -0.00429788, 0.000512402}, 
{-0.000189232, -0.00397342, -0.00527337, -0.00511723, 0.00216438, -0.00720361, -0.0157437, -0.00250101}}; 
double meanQyMinus[nCentBin][nHarmonics] = {{0.000295996, -2.94024e-05, 0.00151365, 0.000166152, 0.000660999, -0.00181372, -0.00110084, -1.00297e-05}, 
{0.000280914, -9.56134e-06, 0.0015156, 0.000158701, 0.000751149, -0.00181498, -0.00108809, 2.10062e-05}, 
{0.000362414, 2.78519e-05, 0.0014822, 0.000201123, 0.000770071, -0.00177992, -0.00111493, 8.91963e-06}, 
{0.000430385, 7.20568e-05, 0.0013864, 0.000147235, 0.000789219, -0.00179293, -0.00105933, -1.15283e-05}, 
{0.000468695, 0.000155764, 0.00141718, 0.000207142, 0.000845736, -0.00177378, -0.00107283, 4.32974e-05}, 
{0.000605809, 0.000191769, 0.00145595, 0.000220353, 0.000845202, -0.00176369, -0.000990588, 0.000107303}, 
{0.000680667, 0.000272855, 0.00145216, 0.000293383, 0.000820704, -0.00174399, -0.000893522, 8.98886e-05}, 
{0.000746867, 0.000568924, 0.00148348, 0.000173312, 0.000802358, -0.00168804, -0.000863602, 9.8464e-05}, 
{0.000874826, 0.000521678, 0.00152456, 0.000250744, 0.000929852, -0.00164739, -0.00072413, 0.000178735}, 
{0.00106231, 0.000796617, 0.00176789, 0.000415899, 0.000914157, -0.00170238, -0.000394783, 0.000221224}, 
{0.00160851, 0.00113344, 0.0019833, 0.000501956, 0.0012714, -0.00164499, 0.000263684, 0.000521522}, 
{0.00276522, 0.00231863, 0.00236812, 0.000733866, 0.00185698, -0.00158702, 0.00176226, 0.00104395}, 
{0.00617463, 0.00515498, 0.00378798, 0.00132881, 0.00373495, -0.0013731, 0.00621795, 0.00256194}, 
{0.0145281, 0.0128252, 0.00724109, 0.00259995, 0.00894913, -0.00083379, 0.0178679, 0.00699055}};



