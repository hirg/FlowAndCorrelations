#include "TComplex.h"
#include <vector>
#include <TVector3.h>

#define nCentBin 13
#define nHarmonics 8
#define nPtBin 14 

using namespace std;
using namespace reco;
using namespace edm;

  bool useRe = true;
  double cBin[nCentBin+1]={0,5,10,15,20,25,30,35,40,50,60,70,80,100};
  double ptBin[nPtBin+1]={0.3, 0.4, 0.5, 0.6, 0.8, 1.0, 1.2, 1.6, 2.0, 2.5, 3.0, 4.0, 6.0, 8.0, 12.0};
  TComplex QhfPlus[nCentBin][nHarmonics];
  TComplex QhfMinus[nCentBin][nHarmonics];
  //TComplex QtrkPlus[nCentBin][nHarmonics];
  //TComplex QtrkMinus[nCentBin][nHarmonics];
  double VnAbs2[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs4[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs6[nCentBin][nHarmonics]={{0.0},{0.0}};
  double V2Abs2V3Abs2[nCentBin]={0.0};
  double V2Abs4V3Abs2[nCentBin]={0.0};
  double V4V2starV2star[nCentBin]={0.0};
  double V6V2starV2starV2star[nCentBin]={0.0};
  double V6V3starV3star[nCentBin]={0.0};
  double V5V2starV3star[nCentBin]={0.0};
  double V7V2starV2starV3star[nCentBin]={0.0};
  double v2Psi2[nCentBin]={0.0};
  double v3Psi3[nCentBin]={0.0};
  double v4Psi2[nCentBin]={0.0};
  double v4Psi4[nCentBin]={0.0};
  double v6Psi2[nCentBin]={0.0};
  double v6Psi3[nCentBin]={0.0};
  double v6Psi6[nCentBin]={0.0};
  double v5Psi2Psi3[nCentBin]={0.0};
  double v7Psi2Psi3[nCentBin]={0.0};
  int nEvent[nCentBin]={0};

  vector<TVector3> *pVect_trkEtaPlus;
  vector<TVector3> *pVect_trkEtaMinus;  
  vector<TVector3> *pVect_hfEtaPlus;
  vector<TVector3> *pVect_hfEtaMinus;  

  TH1D* hMultTrkEtaPlus;
  TH1D* hMultTrkEtaMinus;
  TH1D* hMultHFEtaPlus;
  TH1D* hMultHFEtaMinus;
  TH1D* hQhfPlusX[nCentBin][nHarmonics];
  TH1D* hQhfPlusY[nCentBin][nHarmonics];
  TH1D* hQhfPlusQ[nCentBin][nHarmonics];
  TH1D* hQhfMinusX[nCentBin][nHarmonics];
  TH1D* hQhfMinusY[nCentBin][nHarmonics];
  TH1D* hQhfMinusQ[nCentBin][nHarmonics];
  TH1D* hVnAbs2[nCentBin][nHarmonics];
  TH1D* hVnAbs4[nCentBin][nHarmonics];
  TH1D* hVnAbs6[nCentBin][nHarmonics];
  TH1D* hV2Abs2V3Abs2[nCentBin];
  TH1D* hV2Abs4V3Abs2[nCentBin];

  TH1D* hV2V2star[nCentBin];
  TH1D* hV4V2starV2star[nCentBin];
  TH1D* hV6V2starV2starV2star[nCentBin];
  TH1D* hV6V3starV3star[nCentBin];
  TH1D* hV5V2starV3star[nCentBin];
  TH1D* hV7V2starV2starV3star[nCentBin];

  TH1D* hv2V2star[nCentBin][nPtBin];
  TH1D* hv4V2starV2star[nCentBin][nPtBin];
  TH1D* hv6V2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv6V3starV3star[nCentBin][nPtBin];
  TH1D* hv5V2starV3star[nCentBin][nPtBin];
  TH1D* hv7V2starV2starV3star[nCentBin][nPtBin];



   TH1D* hCent;
   TH1D* hHF;
   TH1D* hAngle;
   TH1D* hAngleFlat;
   TH1D* hvz;
   TH1D* hvx;
   TH1D* hvy;
   TH1D* hNtrks;
   TH1D* hpt;
   TH1D* heta;
   TH1D* hphi;
   TH1D* hHFcal;



double meanQxPlus[nCentBin][nHarmonics] = {{2.25347e-05, -2.11387e-05, 9.94141e-06, -5.41168e-06, 1.68764e-06, -1.39309e-05, -1.04184e-05, 4.6336e-06}, 
{5.43562e-05, -5.20315e-05, 2.16944e-05, -1.29564e-05, 1.82708e-06, -3.89329e-05, -2.45374e-05, 7.33839e-06}, 
{0.000102216, -0.000104166, 4.11861e-05, -2.40337e-05, 1.52889e-07, -8.23046e-05, -5.58498e-05, 2.18456e-06}, 
{0.000174895, -0.000182481, 6.80449e-05, -4.42985e-05, -8.53741e-07, -0.000152483, -0.000102052, -8.69111e-06}, 
{0.000261355, -0.00029181, 0.000109278, -7.02737e-05, -7.8778e-06, -0.000246383, -0.0001708, -3.54231e-05}, 
{0.000356204, -0.00043306, 0.00016877, -0.000101964, -9.437e-06, -0.00035273, -0.000261591, -0.00010331}, 
{0.000451336, -0.000618645, 0.000241083, -0.000114131, -1.72635e-05, -0.000416138, -0.000360855, -0.000242681}, 
{0.000520043, -0.000848023, 0.000367679, -0.000135319, -1.9348e-07, -0.000404404, -0.000489118, -0.000473785}, 
{0.000551662, -0.00126913, 0.000695643, -0.000126503, 0.000147916, -6.09068e-06, -0.000641038, -0.00112656}, 
{7.55302e-05, -0.00184121, 0.00139531, -0.00020953, 0.000498761, 0.00123038, -0.000748209, -0.00244505}, 
{-0.00201758, -0.00174404, 0.00208863, -0.000765738, 0.000658618, 0.0027887, -0.000851356, -0.0033293}, 
{-0.00736875, -4.29379e-05, 0.00227197, -0.00207264, -0.000549664, 0.00337456, -0.00130544, -0.00151247}, 
{-0.0230895, 0.00545364, 0.00179095, -0.00474211, -0.00546467, 0.00191796, -0.00330381, 0.00995511}}; 
double meanQyPlus[nCentBin][nHarmonics] = {{-9.22272e-07, 5.54292e-06, 1.95413e-05, -1.02113e-05, 9.71619e-06, -1.68051e-05, 4.74683e-06, 1.28379e-06}, 
{-5.55808e-06, 1.90373e-05, 4.96123e-05, -2.17773e-05, 2.06133e-05, -3.96332e-05, 6.3685e-06, 6.05229e-06}, 
{-1.32654e-05, 4.03438e-05, 0.000103081, -3.58728e-05, 3.21594e-05, -7.31395e-05, 4.99912e-06, 1.74817e-05}, 
{-2.28225e-05, 7.53771e-05, 0.000187328, -4.46673e-05, 4.84405e-05, -0.000122582, -3.33659e-06, 3.6267e-05}, 
{-2.60881e-05, 0.000103538, 0.00031324, -6.24962e-05, 5.98383e-05, -0.00018077, -3.39888e-05, 5.1999e-05}, 
{-3.74893e-06, 0.000124462, 0.000488745, -8.75913e-05, 7.46161e-05, -0.000241929, -8.52545e-05, 6.96937e-05}, 
{9.41703e-05, 0.000106277, 0.000721002, -0.000121234, 6.85683e-05, -0.000268958, -0.000152764, 7.0621e-05}, 
{0.000306576, 3.16555e-05, 0.00104497, -0.000183886, 3.54438e-05, -0.000252706, -0.000251284, 6.39186e-05}, 
{0.00113111, -0.00020847, 0.00170153, -0.000412355, -9.44563e-05, -9.35199e-05, -0.000359298, -4.10173e-05}, 
{0.00335821, -0.000421102, 0.00277063, -0.00082868, -0.000660912, 0.000249903, -0.000388881, -0.000369132}, 
{0.00688392, 0.00072252, 0.00311066, -0.000650094, -0.00201909, -5.08973e-05, -0.00020932, -0.00143988}, 
{0.0113662, 0.00561662, 0.000799116, 0.00145422, -0.00425113, -0.00240388, -0.000383079, -0.00399541}, 
{0.0197506, 0.0228754, -0.0105486, 0.0103006, -0.00839952, -0.011837, -0.00272446, -0.011666}}; 
double meanQxMinus[nCentBin][nHarmonics] = {{-8.50294e-06, -1.74723e-05, 2.08605e-06, -6.49286e-06, -1.36485e-06, -1.68516e-05, 7.92048e-07, 1.2575e-05}, 
{-3.27097e-05, -3.92624e-05, 1.65821e-06, -1.37847e-05, -5.68997e-06, -5.11615e-05, 6.32118e-06, 2.67937e-05}, 
{-6.86358e-05, -8.69494e-05, 6.98937e-06, -2.83139e-05, -1.1629e-05, -0.000112394, 1.75392e-05, 5.17523e-05}, 
{-0.000134645, -0.000159638, 2.35711e-05, -4.96464e-05, -2.19191e-05, -0.000211108, 3.83951e-05, 9.17354e-05}, 
{-0.000228765, -0.000274286, 4.95174e-05, -7.18378e-05, -3.5076e-05, -0.000345789, 7.14766e-05, 0.000149065}, 
{-0.000362683, -0.000440795, 9.984e-05, -9.25217e-05, -6.01681e-05, -0.00048886, 0.000118524, 0.000233756}, 
{-0.000553084, -0.000636751, 0.00014897, -8.41925e-05, -8.53965e-05, -0.000602828, 0.000189863, 0.00034538}, 
{-0.00086748, -0.000890106, 0.000193267, -3.83808e-05, -0.000101895, -0.000634872, 0.000287533, 0.000501935}, 
{-0.00156236, -0.00132205, 0.000208711, 0.000134524, -8.518e-05, -0.000321444, 0.000519608, 0.000816904}, 
{-0.00303764, -0.00200978, -1.64078e-06, 0.000418303, 7.35689e-05, 0.000774427, 0.000784873, 0.00131259}, 
{-0.00472587, -0.00288805, -0.000595371, 0.00031607, 0.000574919, 0.00167703, 0.000174141, 0.00151476}, 
{-0.00541615, -0.0044483, -0.00164214, -0.000908267, 0.00172898, -0.000100505, -0.00330122, 0.000910251}, 
{-0.000517677, -0.0090994, -0.00395113, -0.00617992, 0.00548402, -0.0125576, -0.0181074, -0.00120973}}; 
double meanQyMinus[nCentBin][nHarmonics] = {{-4.23412e-06, 3.93076e-06, 1.08279e-05, -1.25661e-05, -6.24048e-07, -1.56321e-05, -1.39331e-06, -3.02601e-07}, 
{-1.6042e-05, 1.6626e-05, 2.54452e-05, -2.28419e-05, -7.61836e-06, -2.93937e-05, -7.64284e-06, 8.75614e-06}, 
{-3.54097e-05, 4.30183e-05, 5.96434e-05, -3.71223e-05, -2.1526e-05, -5.33102e-05, -1.66664e-05, 2.43643e-05}, 
{-6.35976e-05, 8.41483e-05, 0.000126609, -5.82999e-05, -3.10589e-05, -8.98999e-05, -1.97358e-05, 5.37214e-05}, 
{-0.000110264, 0.000151988, 0.00023835, -7.67394e-05, -3.33651e-05, -0.000138751, -2.73862e-05, 9.81871e-05}, 
{-0.000144472, 0.000241884, 0.00040005, -9.37026e-05, -1.47153e-05, -0.000207245, -3.6489e-05, 0.000161193}, 
{-0.000143445, 0.000374091, 0.000636807, -5.96915e-05, 4.39078e-05, -0.000298924, -6.75206e-05, 0.00025478}, 
{-3.49231e-05, 0.000569657, 0.000965387, -1.88464e-05, 0.000176207, -0.000445032, -0.000127534, 0.000367091}, 
{0.000594677, 0.00102356, 0.00161262, 0.000191152, 0.000562962, -0.000806453, -0.000270537, 0.00067684}, 
{0.00268138, 0.00223944, 0.00283462, 0.000677599, 0.00133185, -0.00160255, -0.000261943, 0.00129443}, 
{0.00614742, 0.00448302, 0.00433499, 0.00104778, 0.0023799, -0.00255826, 0.000766714, 0.00246695}, 
{0.00996394, 0.00785729, 0.00587621, 0.000965602, 0.00366391, -0.00333918, 0.00438452, 0.00474594}, 
{0.0162233, 0.0144154, 0.00830806, 6.83997e-05, 0.00702523, -0.00347038, 0.0171639, 0.011248}};



