#include "TComplex.h"
#include <vector>
#include <TVector3.h>

#define nCentBin 14
#define nHarmonics 8
#define nPtBin 20 

using namespace std;
using namespace reco;
using namespace edm;

  bool useReDenominator = true;
  bool useRe = true;
  double cBin[nCentBin+1]={0,5,10,15,20,25,30,35,40,50,60,70,80,90,100};
  //double cBin[nCentBin+1]={0,20,60,70,80,81,82,84,86,88,90,92,94,96,100};
  ///double cBin[nCentBin+1]={0,5,50,60,70,80,82,84,86,88,90,92,94,96,100};
  double ptBin[nPtBin+1]={0.3, 0.4, 0.5, 0.6, 0.8, 1.0, 1.25, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 5.0, 6.0, 7.0, 8.0, 10.0, 12.0, 14.0, 20.0};
  const int nPtEffBin=53;
  double effValues[nPtEffBin]={1.75224e-06, 1.75224e-06, 1.75224e-06, 2.81152e-06, 0.0161021, 0.404592, 0.512024, 0.567472, 0.609648, 0.641969, 0.667275, 0.686959, 0.701743, 0.714321, 0.724036, 0.731289, 0.737636, 0.742844, 0.747634, 0.751305, 0.754174, 0.756644, 0.759267, 0.760998, 0.763125, 0.765678, 0.771412, 0.791967, 0.818874, 0.828377, 0.758442, 0.742433, 0.734321, 0.724238, 0.714218, 0.707938, 0.703684, 0.698056, 0.698776, 0.69683, 0.694334, 0.687844, 0.688473, 0.689227, 0.681, 0.683338, 0.687782, 0.671698, 0.680891, 0.673665, 0.669277, 0.681149, 0.681149};
  double ptBinValues[nPtEffBin+1] = {0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1, 1.05, 1.1, 1.15, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.8, 3.2, 3.6, 4, 4.4, 4.8, 5.2, 5.6, 6, 6.4, 6.8, 7.2, 8.4, 9.6, 10.8, 10000};
  TH1D *EffVsPtHist = new TH1D("EffVsPtHist","",nPtEffBin, ptBinValues);
  TComplex QhfPlus[nCentBin][nHarmonics];
  TComplex QhfMinus[nCentBin][nHarmonics];
  TComplex Qhf2p2Plus[nCentBin];
  TComplex Qhf2p2Minus[nCentBin];
  TComplex Qhf2p3Plus[nCentBin];
  TComplex Qhf2p3Minus[nCentBin];
  TComplex Qhf3p3Plus[nCentBin];
  TComplex Qhf3p3Minus[nCentBin];
  TComplex Qhf2p2p2Plus[nCentBin];
  TComplex Qhf2p2p2Minus[nCentBin];
  TComplex Qhf2p2p3Plus[nCentBin];
  TComplex Qhf2p2p3Minus[nCentBin];
  double sumWPlus[nCentBin];
  double sumW2Plus[nCentBin];
  double sumW3Plus[nCentBin];
  double sumWMinus[nCentBin];
  double sumW2Minus[nCentBin];
  double sumW3Minus[nCentBin];
  TComplex QtrkPlus[nCentBin][nHarmonics];
  TComplex QtrkMinus[nCentBin][nHarmonics];
  TComplex QtrkAll[nCentBin][nHarmonics];
  TComplex QtrkPlus1[nCentBin][nHarmonics];
  TComplex QtrkMinus1[nCentBin][nHarmonics];
  TComplex QtrkPt[nCentBin][nHarmonics][nPtBin];
  double VnAbs2[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs4[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs6[nCentBin][nHarmonics]={{0.0},{0.0}};
  double V2Abs2V3Abs2[nCentBin]={0.0};
  double V2Abs4V3Abs2[nCentBin]={0.0};
  double V4V2starV2star[nCentBin]={0.0};
  double V6V2starV2starV2star[nCentBin]={0.0};
  double V6V3starV3star[nCentBin]={0.0};
  double V5V2starV3star[nCentBin]={0.0};
  double V7V2starV2starV3star[nCentBin]={0.0};
  double v2Psi2[nCentBin]={0.0};
  double v3Psi3[nCentBin]={0.0};
  double v4Psi2[nCentBin]={0.0};
  double v4Psi4[nCentBin]={0.0};
  double v6Psi2[nCentBin]={0.0};
  double v6Psi3[nCentBin]={0.0};
  double v6Psi6[nCentBin]={0.0};
  double v5Psi2Psi3[nCentBin]={0.0};
  double v7Psi2Psi3[nCentBin]={0.0};
  int nEvent[nCentBin]={0};

  vector<TVector3> *pVect_trkEtaPlus;
  vector<TVector3> *pVect_trkEtaMinus;  
  vector<TVector3> *pVect_hfEtaPlus;
  vector<TVector3> *pVect_hfEtaMinus;  

  TH1D* hMultTrkEtaPlus;
  TH1D* hMultTrkEtaMinus;
  TH1D* hMultHFEtaPlus;
  TH1D* hMultHFEtaMinus;
  TH1D* hQhfPlusX[nCentBin][nHarmonics];
  TH1D* hQhfPlusY[nCentBin][nHarmonics];
  TH1D* hQhfPlusQ[nCentBin][nHarmonics];
  TH1D* hQhfMinusX[nCentBin][nHarmonics];
  TH1D* hQhfMinusY[nCentBin][nHarmonics];
  TH1D* hQhfMinusQ[nCentBin][nHarmonics];
  TH1D* hQtrkPlusX[nCentBin][nHarmonics];
  TH1D* hQtrkPlusY[nCentBin][nHarmonics];
  TH1D* hQtrkMinusX[nCentBin][nHarmonics];
  TH1D* hQtrkMinusY[nCentBin][nHarmonics];
  TH1D* hQtrkPtX[nCentBin][nHarmonics][nPtBin];
  TH1D* hQtrkPtY[nCentBin][nHarmonics][nPtBin];
  TH1D* hVnAbs2[nCentBin][nHarmonics];
  TH1D* hVnAbs4[nCentBin][nHarmonics];
  TH1D* hVnAbs6[nCentBin][nHarmonics];
  TH1D* hVnAbs8[nCentBin][nHarmonics];
  TH1D* hV2Abs2V3Abs2[nCentBin];
  TH1D* hV2Abs4V3Abs2[nCentBin];
  TH1D* hV2Abs2V3Abs4[nCentBin];
  //trk 
  TH1D* hV2Abs4trk1[nCentBin];
  TH1D* hV2Abs6trk1[nCentBin];
  TH1D* hV3Abs4trk1[nCentBin];
  TH1D* hV2Abs2V3Abs2trk1[nCentBin];
  TH1D* hV2Abs4V3Abs2trk1[nCentBin];
  TH1D* hV2Abs4trk12[nCentBin];
  TH1D* hV2Abs6trk12[nCentBin];
  TH1D* hV3Abs4trk12[nCentBin];
  TH1D* hV2Abs2V3Abs2trk12[nCentBin];
  TH1D* hV2Abs4V3Abs2trk12[nCentBin];
  TH1D* hV2Abs4trk2[nCentBin];
  TH1D* hV2Abs6trk2[nCentBin];
  TH1D* hV3Abs4trk2[nCentBin];
  TH1D* hV2Abs2V3Abs2trk2[nCentBin];
  TH1D* hV2Abs4V3Abs2trk2[nCentBin];

  //only Qtrk
  TH1D* hV2V2starQtrk[nCentBin];
  TH1D* hV4V2starV2starQtrk[nCentBin];
  TH1D* hV6V2starV2starV2starQtrk[nCentBin];
  TH1D* hV6V3starV3starQtrk[nCentBin];
  TH1D* hV5V2starV3starQtrk[nCentBin];
  TH1D* hV7V2starV2starV3starQtrk[nCentBin];
  TH1D* hV2Abs2Qtrk[nCentBin];
  TH1D* hV2Abs4Qtrk[nCentBin];
  TH1D* hV2Abs6Qtrk[nCentBin];
  TH1D* hV3Abs4Qtrk[nCentBin];
  TH1D* hV2Abs2V3Abs2Qtrk[nCentBin];
  TH1D* hV2Abs4V3Abs2Qtrk[nCentBin];
  //only QtrkHF
  TH1D* hV2V2starQtrkHF[nCentBin];
  TH1D* hV4V2starV2starQtrkHF[nCentBin];
  TH1D* hV6V2starV2starV2starQtrkHF[nCentBin];
  TH1D* hV6V3starV3starQtrkHF[nCentBin];
  TH1D* hV5V2starV3starQtrkHF[nCentBin];
  TH1D* hV7V2starV2starV3starQtrkHF[nCentBin];
  TH1D* hV2Abs2QtrkHF[nCentBin];
  TH1D* hV2Abs4QtrkHF[nCentBin];
  TH1D* hV2Abs6QtrkHF[nCentBin];
  TH1D* hV3Abs4QtrkHF[nCentBin];
  TH1D* hV2Abs2V3Abs2QtrkHF[nCentBin];
  TH1D* hV2Abs4V3Abs2QtrkHF[nCentBin];

  TH1D* hV2V2star[nCentBin];
  TH1D* hV4V2starV2star[nCentBin];
  TH1D* hV6V2starV2starV2star[nCentBin];
  TH1D* hV6V3starV3star[nCentBin];
  TH1D* hV5V2starV3star[nCentBin];
  TH1D* hV7V2starV2starV3star[nCentBin];

  TH1D* hv2V2star[nCentBin][nPtBin];
  TH1D* hv3V3star[nCentBin][nPtBin];
  TH1D* hv4V4star[nCentBin][nPtBin];
  TH1D* hv5V5star[nCentBin][nPtBin];
  TH1D* hv6V6star[nCentBin][nPtBin];
  TH1D* hv7V7star[nCentBin][nPtBin];
  TH1D* hv8V8star[nCentBin][nPtBin];
  TH1D* hv4V2starV2star[nCentBin][nPtBin];
  TH1D* hv4V2starV2starAB[nCentBin][nPtBin];
  TH1D* hv4V2starV2starSub[nCentBin][nPtBin];
  TH1D* hv6V2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv6V2starV2starV2starAB[nCentBin][nPtBin];
  TH1D* hv6V2starV2starV2starSub[nCentBin][nPtBin];
  TH1D* hv6V3starV3star[nCentBin][nPtBin];
  TH1D* hv6V3starV3starAB[nCentBin][nPtBin];
  TH1D* hv6V3starV3starSub[nCentBin][nPtBin];
  TH1D* hv5V2starV3star[nCentBin][nPtBin];
  TH1D* hv5V2starV3starAB[nCentBin][nPtBin];
  TH1D* hv5V2starV3starSub[nCentBin][nPtBin];
  TH1D* hv7V2starV2starV3star[nCentBin][nPtBin];
  TH1D* hv7V2starV2starV3starAB[nCentBin][nPtBin];
  TH1D* hv7V2starV2starV3starSub[nCentBin][nPtBin];
  TH1D* hv8V2starV2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv8V2starV3starV3star[nCentBin][nPtBin];

  TH1D* hq4Q2starQ2starAA[nCentBin][nPtBin];
  TH1D* hq4Q2starQ2starBB[nCentBin][nPtBin];
  TH1D* hq4Q2starQ2starAB[nCentBin][nPtBin];
  TH1D* hq6Q2starQ2starQ2starAA[nCentBin][nPtBin];
  TH1D* hq6Q2starQ2starQ2starBB[nCentBin][nPtBin];
  TH1D* hq6Q2starQ2starQ2starAB[nCentBin][nPtBin];
  TH1D* hq6Q3starQ3starAA[nCentBin][nPtBin];
  TH1D* hq6Q3starQ3starBB[nCentBin][nPtBin];
  TH1D* hq6Q3starQ3starAB[nCentBin][nPtBin];
  TH1D* hq5Q2starQ3starAA[nCentBin][nPtBin];
  TH1D* hq5Q2starQ3starBB[nCentBin][nPtBin];
  TH1D* hq5Q2starQ3starAB[nCentBin][nPtBin];
  TH1D* hq7Q2starQ2starQ3starAA[nCentBin][nPtBin];
  TH1D* hq7Q2starQ2starQ3starBB[nCentBin][nPtBin];
  TH1D* hq7Q2starQ2starQ3starAB[nCentBin][nPtBin];
  TH1D* hQ2Abs4AA[nCentBin][nPtBin];
  TH1D* hQ2Abs4BB[nCentBin][nPtBin];
  TH1D* hQ2Abs4AB[nCentBin][nPtBin];
  TH1D* hQ2Abs6AA[nCentBin][nPtBin];
  TH1D* hQ2Abs6BB[nCentBin][nPtBin];
  TH1D* hQ2Abs6AB[nCentBin][nPtBin];
  TH1D* hQ3Abs4AA[nCentBin][nPtBin];
  TH1D* hQ3Abs4BB[nCentBin][nPtBin];
  TH1D* hQ3Abs4AB[nCentBin][nPtBin];
  TH1D* hQ2Abs2Q3Abs2AA[nCentBin][nPtBin];
  TH1D* hQ2Abs2Q3Abs2BB[nCentBin][nPtBin];
  TH1D* hQ2Abs2Q3Abs2AB[nCentBin][nPtBin];
  TH1D* hQ2Abs4Q3Abs2AA[nCentBin][nPtBin];
  TH1D* hQ2Abs4Q3Abs2BB[nCentBin][nPtBin];
  TH1D* hQ2Abs4Q3Abs2AB[nCentBin][nPtBin];


  TH1D* hMeanPt[nCentBin][nPtBin];


   TH1D* hCent;
   TH1D* hHF;
   TH1D* hAngle;
   TH1D* hAngleFlat;
   TH1D* hvz;
   TH1D* hvx;
   TH1D* hvy;
   TH1D* hNtrks;
   TH1D* hpt;
   TH1D* heta;
   TH1D* hphi;
   TH1D* hHFcal;

// Cent. Dep.
double meanQxPlus[nCentBin][nHarmonics] = {{0.00825461, -0.00241016, 0.00337191, -0.00396656, 0.00138415, -0.00135485, 0.00346934, 0.000644607}, 
{0.00817788, -0.00241585, 0.00343944, -0.00401674, 0.00134868, -0.00130418, 0.00351441, 0.000688646}, 
{0.00799869, -0.00238845, 0.00338213, -0.00400729, 0.0012606, -0.00122982, 0.00348964, 0.00075723}, 
{0.00776149, -0.00226531, 0.0033366, -0.00394489, 0.00114503, -0.00114818, 0.00340012, 0.000913712}, 
{0.00745779, -0.00216804, 0.00323138, -0.00387088, 0.000969127, -0.00104774, 0.00326052, 0.0011083}, 
{0.00718402, -0.00203224, 0.00312575, -0.00374878, 0.00079568, -0.000998851, 0.00307037, 0.00130743}, 
{0.00694299, -0.00195708, 0.00300394, -0.00364575, 0.000617625, -0.000976291, 0.00295057, 0.00148288}, 
{0.00676188, -0.0020505, 0.00296936, -0.00358566, 0.000449574, -0.000912829, 0.00280369, 0.00160832}, 
{0.00651748, -0.00195369, 0.00281823, -0.00358005, 0.000312697, -0.000848912, 0.00274405, 0.00172315}, 
{0.0057635, -0.00198008, 0.00268243, -0.00364696, 0.000148405, -0.000779687, 0.00286477, 0.0019027}, 
{0.00366617, -0.00206497, 0.00245967, -0.00376884, -0.000103686, -0.000727682, 0.00321325, 0.0022733}, 
{-0.00205154, -0.0021207, 0.00196684, -0.00408603, -0.000721438, -0.000873601, 0.00436244, 0.00319228}, 
{-0.0178012, -0.00231502, 0.000809963, -0.0047179, -0.0024415, -0.00107883, 0.00745695, 0.00574547}, 
{-0.0492652, -0.00211684, -0.00356579, -0.00736054, -0.00460148, -0.0017113, 0.0135066, 0.0126398}}; 
double meanQyPlus[nCentBin][nHarmonics] = {{0.000724112, 0.00320573, 0.000102156, -0.000858806, -0.000471839, 0.00157341, 3.42903e-05, -0.00124272}, 
{0.000740774, 0.0032578, 4.3957e-05, -0.000861521, -0.000526346, 0.00167498, -1.48681e-06, -0.00127073}, 
{0.000757906, 0.00333541, 3.0742e-05, -0.0008774, -0.000569968, 0.00175937, -1.48155e-05, -0.00126635}, 
{0.000762246, 0.00338204, -4.77451e-05, -0.000843387, -0.000644269, 0.00179152, -3.86878e-05, -0.00127228}, 
{0.000831779, 0.0034612, -0.000101867, -0.000779176, -0.000694892, 0.0017992, -4.07154e-05, -0.0012694}, 
{0.000836299, 0.00340938, -0.000131232, -0.000706701, -0.000783204, 0.00178374, -7.62698e-05, -0.00122374}, 
{0.000814022, 0.00353743, -0.000139246, -0.00062762, -0.000820724, 0.00180374, -9.91796e-05, -0.00116202}, 
{0.000832374, 0.00335005, -0.000131357, -0.000555593, -0.000854886, 0.00182321, -9.36168e-05, -0.00114793}, 
{0.000920494, 0.00338455, -0.000173354, -0.000474306, -0.000905697, 0.00189623, -7.49071e-05, -0.00114588}, 
{0.00108445, 0.00342862, -0.000365927, -0.000331261, -0.00102579, 0.00201003, -5.03664e-05, -0.00123475}, 
{0.00150539, 0.00381687, -0.00108986, 0.000429513, -0.00133652, 0.00219358, -1.16581e-05, -0.00143517}, 
{0.0025587, 0.00453414, -0.00303028, 0.00293238, -0.00221282, 0.00250926, -9.95322e-05, -0.00187416}, 
{0.00510432, 0.00655026, -0.00837808, 0.0100169, -0.0048772, 0.00361074, -0.000199134, -0.00292424}, 
{0.00915456, 0.0121779, -0.0203523, 0.0263778, -0.0114609, 0.00756163, -0.00112471, -0.00627075}}; 
double meanQxMinus[nCentBin][nHarmonics] = {{0.00034484, -0.000629835, -0.00265871, 0.00181358, 0.00501423, 0.00141866, -0.000986771, 0.00337395}, 
{0.000304915, -0.000667401, -0.00262049, 0.00188193, 0.00496456, 0.00137764, -0.00101845, 0.00335943}, 
{0.000286701, -0.000708244, -0.00259604, 0.00191231, 0.00490374, 0.00129682, -0.00107282, 0.00334947}, 
{0.00029612, -0.000689396, -0.00257273, 0.00195516, 0.00486451, 0.00116658, -0.00116007, 0.00333918}, 
{0.000343457, -0.000732675, -0.00252666, 0.00193635, 0.00481185, 0.00105733, -0.00129628, 0.00331743}, 
{0.000444364, -0.000784003, -0.00247066, 0.00191772, 0.004757, 0.000942839, -0.00142263, 0.00325708}, 
{0.000523945, -0.000760759, -0.0024535, 0.00186703, 0.00474219, 0.000872901, -0.00155412, 0.00320681}, 
{0.000590454, -0.000952728, -0.00248459, 0.00178169, 0.00471089, 0.000824723, -0.00162757, 0.00318978}, 
{0.000735756, -0.00104325, -0.00242549, 0.00174381, 0.00475471, 0.000844758, -0.00171154, 0.00314188}, 
{0.000958856, -0.00107214, -0.00245451, 0.00180678, 0.00489109, 0.000832386, -0.00185514, 0.003001}, 
{0.00141066, -0.00109529, -0.00240799, 0.00210056, 0.00501654, 0.000447538, -0.00241542, 0.00243208}, 
{0.0026587, -0.0010495, -0.00230661, 0.00294177, 0.00520642, -0.000985969, -0.00404178, 0.000794532}, 
{0.00642516, -0.000566967, -0.00218301, 0.00493984, 0.00567292, -0.00519472, -0.00854683, -0.00405288}, 
{0.0161074, 0.000810539, -0.00186677, 0.00948545, 0.00682072, -0.0149986, -0.019458, -0.0152394}}; 
double meanQyMinus[nCentBin][nHarmonics] = {{0.0066803, 0.0077966, -0.00247612, -0.00472074, -8.20974e-05, 0.00106848, 0.000233455, -0.000614268}, 
{0.0066583, 0.00779324, -0.00241091, -0.00474185, -0.00015128, 0.00109548, 0.000202852, -0.000554761}, 
{0.00658827, 0.0078069, -0.00237797, -0.00479458, -0.000223929, 0.00113565, 0.00021824, -0.000514281}, 
{0.00655716, 0.00778752, -0.00234793, -0.00479242, -0.000346952, 0.00118157, 0.000229814, -0.000468338}, 
{0.00644154, 0.00784283, -0.00227063, -0.00479176, -0.000427375, 0.00124594, 0.000264169, -0.000459451}, 
{0.00636233, 0.00774696, -0.00222736, -0.00469285, -0.000530638, 0.00130392, 0.000305331, -0.000437648}, 
{0.00628668, 0.00787854, -0.00218175, -0.00460761, -0.000571689, 0.00133329, 0.000316034, -0.000489724}, 
{0.00616319, 0.0077664, -0.00212356, -0.00454355, -0.000574296, 0.00131437, 0.00034393, -0.000576605}, 
{0.0060861, 0.00781674, -0.00212597, -0.00440826, -0.000516753, 0.001333, 0.000455789, -0.000645116}, 
{0.00597675, 0.00790467, -0.00198857, -0.00420508, -0.000625397, 0.00135649, 0.000800141, -0.000602572}, 
{0.00554234, 0.00771593, -0.00173418, -0.00383516, -0.000889883, 0.00146482, 0.00164023, -0.00033963}, 
{0.0043614, 0.00693119, -0.0011636, -0.00283674, -0.00163878, 0.00199465, 0.00404426, 0.000623038}, 
{0.000799485, 0.00466981, 0.000420673, 9.32649e-05, -0.0037651, 0.00327289, 0.0107178, 0.0035763}, 
{-0.00801239, -0.00127426, 0.00415683, 0.00652361, -0.00891499, 0.00664707, 0.026584, 0.0103968}}; 

double meanQxTrkPlus[nCentBin][nHarmonics] = {{0.0204517, 0.0189064, -0.00851181, -0.00475269, -0.0133754, 0.018844, 0.00616347, -0.0226291}, 
{0.0213803, 0.0195094, -0.00858468, -0.00483788, -0.0134215, 0.0188635, 0.00598418, -0.0229411}, 
{0.0219228, 0.0198474, -0.00865255, -0.00489736, -0.0134313, 0.0188733, 0.00592669, -0.0231491}, 
{0.0222239, 0.0201614, -0.00867211, -0.00493582, -0.0134524, 0.0189346, 0.00588408, -0.0232279}, 
{0.0223969, 0.0203152, -0.00867808, -0.00501109, -0.0134692, 0.0189745, 0.00586031, -0.0233162}, 
{0.0225456, 0.0205231, -0.00862652, -0.00504363, -0.013446, 0.0189994, 0.0058313, -0.0233693}, 
{0.0226676, 0.0207514, -0.00862192, -0.00504157, -0.0134339, 0.0190173, 0.00582429, -0.0234131}, 
{0.0227763, 0.0206728, -0.00858903, -0.00510323, -0.0134522, 0.0190736, 0.00585147, -0.0234408}, 
{0.0229961, 0.0208816, -0.00859315, -0.00508303, -0.0134683, 0.0190752, 0.00579665, -0.0234217}, 
{0.0231457, 0.0212046, -0.0086189, -0.0051987, -0.0134528, 0.0191584, 0.00574969, -0.0234763}, 
{0.0232962, 0.0213281, -0.00870509, -0.00518777, -0.0134451, 0.0191515, 0.00572816, -0.0234377}, 
{0.0234098, 0.0213056, -0.00870233, -0.00510706, -0.0133922, 0.0189441, 0.00576637, -0.0233229}, 
{0.0235413, 0.0212289, -0.00870398, -0.00480344, -0.0133008, 0.0186034, 0.00547338, -0.0230377}, 
{0.0221731, 0.0196404, -0.00818268, -0.00354543, -0.0126854, 0.0168816, 0.00467913, -0.0206245}}; 
double meanQyTrkPlus[nCentBin][nHarmonics] = {{-0.0169185, 0.0147606, -0.00910912, 0.0115255, -0.00270227, -0.012097, 0.00996007, -0.000494378}, 
{-0.0156096, 0.0147886, -0.00885144, 0.0117007, -0.00250978, -0.0119982, 0.00997856, -0.000828738}, 
{-0.0148225, 0.0147948, -0.00868756, 0.0117976, -0.00245016, -0.0119614, 0.00998622, -0.0009433}, 
{-0.0144485, 0.0147936, -0.0086095, 0.0118665, -0.00243056, -0.0119646, 0.00999743, -0.000963875}, 
{-0.0142156, 0.0148007, -0.00855009, 0.0119208, -0.00241877, -0.0119901, 0.00995377, -0.00092993}, 
{-0.0140428, 0.0146841, -0.00850964, 0.0119433, -0.00243554, -0.0119902, 0.00999439, -0.000925767}, 
{-0.0139446, 0.0148138, -0.00848526, 0.0119571, -0.00241044, -0.0120232, 0.00996066, -0.000917647}, 
{-0.0138182, 0.0146084, -0.00844811, 0.0119956, -0.00239092, -0.0120021, 0.00999394, -0.00092366}, 
{-0.0136782, 0.0146704, -0.00847712, 0.0120172, -0.00240605, -0.0120696, 0.00994311, -0.000885351}, 
{-0.0135689, 0.0146864, -0.00844194, 0.0121004, -0.0024014, -0.0121122, 0.00993617, -0.000876702}, 
{-0.0134098, 0.0146371, -0.00844406, 0.0121623, -0.00236889, -0.0121692, 0.0100596, -0.000845566}, 
{-0.0133751, 0.0145472, -0.00837622, 0.0120607, -0.00230977, -0.0122005, 0.0100746, -0.000985964}, 
{-0.0131914, 0.0136576, -0.00829639, 0.0119764, -0.00230022, -0.0123046, 0.0100531, -0.000524196}, 
{-0.0123803, 0.0101762, -0.0080072, 0.0108568, -0.00202282, -0.0117843, 0.00985604, 0.000159814}}; 
double meanQxTrkMinus[nCentBin][nHarmonics] = {{0.0425412, 0.00583877, -0.00573884, 0.0102034, -0.0405312, 0.0468259, -0.00707534, -0.0174639}, 
{0.0431434, 0.00614952, -0.00576233, 0.0100943, -0.0404296, 0.0469445, -0.00709249, -0.0177963}, 
{0.043419, 0.00629362, -0.00575178, 0.0100114, -0.040377, 0.0470133, -0.00714942, -0.0180336}, 
{0.0435814, 0.00648877, -0.00576102, 0.0099509, -0.0403543, 0.0470842, -0.00717963, -0.0181399}, 
{0.0436596, 0.00659732, -0.00572454, 0.0098578, -0.0403279, 0.0471487, -0.00716543, -0.0182376}, 
{0.0436895, 0.00680152, -0.00572144, 0.00983255, -0.040325, 0.0472102, -0.00722311, -0.0183041}, 
{0.0437419, 0.0070018, -0.00565886, 0.00980783, -0.040304, 0.0472451, -0.00723764, -0.0183495}, 
{0.0438553, 0.0069564, -0.00570882, 0.0097545, -0.0403353, 0.0473178, -0.00724054, -0.0183908}, 
{0.0440232, 0.00708616, -0.00563062, 0.00977373, -0.0403881, 0.0473487, -0.00722555, -0.0184384}, 
{0.0441325, 0.00733587, -0.005711, 0.00966, -0.0404066, 0.0474429, -0.00726766, -0.0184493}, 
{0.0442586, 0.00749235, -0.00581716, 0.00957634, -0.0403866, 0.0473257, -0.00722097, -0.0184759}, 
{0.0443836, 0.00728563, -0.00589861, 0.00964186, -0.0404585, 0.04725, -0.00720481, -0.0183824}, 
{0.0443198, 0.00713164, -0.00595018, 0.00960604, -0.0406514, 0.0467687, -0.00711703, -0.0180079}, 
{0.0411783, 0.00612445, -0.00510044, 0.00971949, -0.0379041, 0.0427826, -0.00664979, -0.0164658}}; 
double meanQyTrkMinus[nCentBin][nHarmonics] = {{-0.0366917, 0.0420423, -0.0347616, 0.0363171, -0.0132328, -0.0229086, 0.0309576, -0.0133088}, 
{-0.0355463, 0.0421184, -0.0347785, 0.0362812, -0.0131163, -0.0226883, 0.0310502, -0.0137999}, 
{-0.0349122, 0.0421232, -0.034735, 0.0362236, -0.0130652, -0.0225737, 0.0310468, -0.0139575}, 
{-0.0346075, 0.0420818, -0.0347319, 0.0361997, -0.0130458, -0.0225027, 0.031049, -0.014072}, 
{-0.0344435, 0.0420843, -0.0346993, 0.0362041, -0.0130496, -0.0224826, 0.0309962, -0.0140763}, 
{-0.0343117, 0.0419734, -0.0346703, 0.0362148, -0.0130804, -0.0224143, 0.0309965, -0.0141024}, 
{-0.0342645, 0.042053, -0.0346237, 0.0362187, -0.0131016, -0.0224641, 0.0309778, -0.0140749}, 
{-0.0342147, 0.0419646, -0.034601, 0.0362489, -0.0131078, -0.0224719, 0.0309485, -0.0141118}, 
{-0.0341341, 0.0420392, -0.0346439, 0.036253, -0.0131222, -0.0225224, 0.0309251, -0.0140576}, 
{-0.034109, 0.042136, -0.0346248, 0.0363154, -0.0131885, -0.0225268, 0.03088, -0.0139737}, 
{-0.0341684, 0.0422031, -0.0346881, 0.0364473, -0.013192, -0.0225978, 0.0309024, -0.0138805}, 
{-0.0341261, 0.0422134, -0.0347133, 0.036388, -0.0131767, -0.0225749, 0.030773, -0.0138251}, 
{-0.0341811, 0.0413021, -0.0344819, 0.0363781, -0.0128074, -0.0227607, 0.0306576, -0.0135167}, 
{-0.0317334, 0.0357026, -0.0320693, 0.0336932, -0.0123149, -0.0214957, 0.0283907, -0.011187}}; 

/*
// Pt Dep.
double meanQxPlus[nCentBin][nHarmonics] = {{0.0080498, -0.00237185, 0.00338257, -0.00398372, 0.00128469, -0.00125992, 0.00346853, 0.000751017}, 
{0.0066224, -0.00200558, 0.00292007, -0.00366088, 0.000471981, -0.000897291, 0.00291426, 0.00159004}, 
{0.00367381, -0.00206335, 0.00245987, -0.00375759, -0.000107739, -0.000730602, 0.00321681, 0.00227076}, 
{-0.00208729, -0.00212497, 0.00198523, -0.0040851, -0.00071037, -0.000880655, 0.00435144, 0.00318513}, 
{-0.00791836, -0.00206489, 0.00158284, -0.0043281, -0.00148188, -0.000857994, 0.00549015, 0.00421753}, 
{-0.00964959, -0.0022677, 0.00138058, -0.00440143, -0.00179094, -0.00107673, 0.00580276, 0.00423917}, 
{-0.0124312, -0.00222114, 0.00133718, -0.00457435, -0.00184681, -0.00101703, 0.00625032, 0.00480728}, 
{-0.0170898, -0.002279, 0.000775118, -0.00470288, -0.00232342, -0.00104431, 0.00721571, 0.0056534}, 
{-0.0224277, -0.00238109, 0.000635089, -0.00477327, -0.00279576, -0.00120104, 0.00845073, 0.00658221}, 
{-0.0289834, -0.00244597, -0.000152896, -0.00528132, -0.0037309, -0.00121439, 0.00983186, 0.00754991}, 
{-0.0368238, -0.00224333, -0.000599853, -0.00556201, -0.00446701, -0.00125869, 0.0111395, 0.00882906}, 
{-0.0453696, -0.00231487, -0.00157755, -0.00582589, -0.00495082, -0.00154191, 0.0129906, 0.0104967}, 
{-0.0537156, -0.00209255, -0.0029541, -0.00686734, -0.00563178, -0.00161322, 0.0143214, 0.0124604}, 
{-0.0597162, -0.00203188, -0.00819643, -0.010636, -0.00361574, -0.00223891, 0.015238, 0.0178336}}; 
double meanQyPlus[nCentBin][nHarmonics] = {{0.000745925, 0.00328979, 3.27755e-05, -0.000860006, -0.000554476, 0.00169851, -5.03429e-06, -0.00126284}, 
{0.000909066, 0.00341967, -0.000195601, -0.000537704, -0.000876383, 0.00187694, -6.77532e-05, -0.00119545}, 
{0.00149257, 0.00383172, -0.00107711, 0.000436741, -0.00133562, 0.00218258, -1.25784e-05, -0.00143206}, 
{0.00254295, 0.00454876, -0.00301406, 0.00294475, -0.00222975, 0.00253355, -0.000104179, -0.00188481}, 
{0.00353955, 0.00526634, -0.00478857, 0.00546796, -0.0031637, 0.00306959, 8.34483e-06, -0.00216385}, 
{0.00369091, 0.00557609, -0.00542451, 0.00651488, -0.00339168, 0.00284391, -0.000257617, -0.00235101}, 
{0.00420476, 0.00573454, -0.00661099, 0.00777167, -0.00400984, 0.00325121, -4.36221e-05, -0.00261321}, 
{0.00490898, 0.00647229, -0.00816581, 0.00949708, -0.0045884, 0.00365264, -0.000212563, -0.00294209}, 
{0.00580427, 0.0070921, -0.01001, 0.0121449, -0.00582804, 0.00384595, -0.000217412, -0.00319126}, 
{0.00699753, 0.00807624, -0.0121958, 0.0149754, -0.00677846, 0.00436297, -0.000396491, -0.0036484}, 
{0.0080667, 0.00892379, -0.0150235, 0.018749, -0.00818624, 0.0049367, -0.000631648, -0.00445129}, 
{0.00944234, 0.0104243, -0.0180004, 0.0229549, -0.00965733, 0.00587135, -0.000772799, -0.00504905}, 
{0.0104178, 0.0119852, -0.0214844, 0.0275563, -0.0116213, 0.00724525, -0.000970909, -0.00597738}, 
{0.00893572, 0.0166276, -0.0260147, 0.0349784, -0.0157369, 0.0115669, -0.00202151, -0.00917279}}; 
double meanQxMinus[nCentBin][nHarmonics] = {{0.000312992, -0.000676116, -0.00261487, 0.00189036, 0.00493743, 0.00131586, -0.00105913, 0.00335445}, 
{0.000663314, -0.000926019, -0.00246552, 0.00182469, 0.00478924, 0.000880998, -0.00162429, 0.003158}, 
{0.00142309, -0.00110508, -0.00240519, 0.00210809, 0.00502592, 0.000450614, -0.00240952, 0.00243785}, 
{0.00263768, -0.00105599, -0.00231009, 0.00291516, 0.00521059, -0.000976479, -0.0040356, 0.000808745}, 
{0.00391819, -0.000680527, -0.00235216, 0.00366445, 0.00540672, -0.00262041, -0.00573472, -0.00112808}, 
{0.00430348, -0.000654649, -0.00229982, 0.0039099, 0.00556898, -0.00304929, -0.00633166, -0.0016132}, 
{0.00510362, -0.000659719, -0.00220908, 0.00417923, 0.00551009, -0.00377457, -0.00696612, -0.00230821}, 
{0.00626814, -0.00059155, -0.00210066, 0.0048929, 0.00544497, -0.00506222, -0.00836166, -0.00358333}, 
{0.00753302, -0.00030122, -0.00198283, 0.00567532, 0.00564417, -0.00638585, -0.00989071, -0.00560692}, 
{0.00927349, -0.000443619, -0.00219398, 0.00624948, 0.00616766, -0.00801478, -0.0116537, -0.00757678}, 
{0.0114497, 4.02243e-05, -0.0019617, 0.00744316, 0.00615246, -0.0101509, -0.0139997, -0.00974726}, 
{0.0135569, 0.000541856, -0.00192671, 0.00861442, 0.00640469, -0.0125128, -0.0164072, -0.0126793}, 
{0.0162718, 0.0003176, -0.00180438, 0.00996019, 0.00662291, -0.0156005, -0.0199954, -0.0159993}, 
{0.0221106, 0.00203102, -0.00164802, 0.0115961, 0.00784652, -0.0208011, -0.0262704, -0.0214082}}; 
double meanQyMinus[nCentBin][nHarmonics] = {{0.00662163, 0.00779574, -0.00240231, -0.00476228, -0.000201201, 0.00112048, 0.000219957, -0.000539163}, 
{0.00617795, 0.00783522, -0.00212736, -0.0044812, -0.000546981, 0.00132085, 0.000466247, -0.000556079}, 
{0.00554535, 0.00773258, -0.0017316, -0.00383684, -0.000896729, 0.00146148, 0.00163522, -0.000354424}, 
{0.00436089, 0.00692243, -0.00115986, -0.00282848, -0.00163053, 0.00199989, 0.00402231, 0.000635346}, 
{0.00304961, 0.00615701, -0.000505636, -0.00174666, -0.00257792, 0.00241887, 0.0064886, 0.00171405}, 
{0.00260787, 0.00587456, -0.000478929, -0.00137282, -0.002601, 0.00256555, 0.0071578, 0.00211308}, 
{0.00226601, 0.00541032, -9.2612e-06, -0.000997306, -0.00311846, 0.00284759, 0.00840703, 0.00263197}, 
{0.000938064, 0.0049135, 0.000318785, -9.79301e-05, -0.00371961, 0.0031843, 0.0104599, 0.00335578}, 
{-0.000264599, 0.00388171, 0.000817318, 0.00100598, -0.00425631, 0.00360048, 0.0126629, 0.00437124}, 
{-0.0017855, 0.00283297, 0.00157456, 0.00208598, -0.0050926, 0.00429085, 0.0156196, 0.00574868}, 
{-0.00365118, 0.00127906, 0.00237084, 0.00353662, -0.00651892, 0.00484728, 0.0189693, 0.00698187}, 
{-0.00575335, -9.61933e-05, 0.00323645, 0.00500166, -0.007523, 0.00578412, 0.0228709, 0.00867897}, 
{-0.00834537, -0.00146895, 0.00466696, 0.006838, -0.00916298, 0.00682038, 0.0275139, 0.010917}, 
{-0.0134112, -0.00434472, 0.00612841, 0.0101992, -0.0119611, 0.00877649, 0.0354995, 0.0142291}};

double meanQxTrkPlus[nCentBin][nHarmonics] = {{0.0215011, 0.0195912, -0.00859279, -0.00486696, -0.0134134, 0.0188735, 0.00599783, -0.022991}, 
{0.0228426, 0.0207963, -0.00860748, -0.0051037, -0.0134474, 0.0190561, 0.00581575, -0.0234257}, 
{0.023309, 0.0213198, -0.00869872, -0.00520212, -0.0134461, 0.0191487, 0.00572128, -0.0234342}, 
{0.0234383, 0.0213064, -0.00869542, -0.00511984, -0.0133533, 0.0189346, 0.00576936, -0.0233121}, 
{0.0237856, 0.0213409, -0.00882675, -0.00480135, -0.0132608, 0.0189392, 0.00532213, -0.0232679}, 
{0.0232333, 0.0214457, -0.0089502, -0.0048837, -0.0134515, 0.0190242, 0.00559036, -0.0228592}, 
{0.0237816, 0.0211864, -0.00879401, -0.00491256, -0.013183, 0.0188657, 0.00559432, -0.0232743}, 
{0.0237195, 0.0215156, -0.00872635, -0.00484157, -0.0134632, 0.018389, 0.00542548, -0.023197}, 
{0.0237893, 0.0209931, -0.00824007, -0.00474157, -0.0132616, 0.0186938, 0.00527935, -0.0231245}, 
{0.0230987, 0.0210838, -0.00879432, -0.0046995, -0.0133826, 0.0180501, 0.00562394, -0.0227783}, 
{0.0237056, 0.0207252, -0.00830435, -0.0048854, -0.0137182, 0.0184678, 0.0050565, -0.0219632}, 
{0.0232286, 0.0198719, -0.0087231, -0.00444387, -0.0124706, 0.0174137, 0.00539782, -0.0212981}, 
{0.0214775, 0.0196526, -0.00817926, -0.00257182, -0.0126005, 0.0163641, 0.00512008, -0.0204618}, 
{0.0203627, 0.018558, -0.00766149, -0.0025783, -0.0116907, 0.0155103, 0.00350309, -0.0191364}}; 
double meanQyTrkPlus[nCentBin][nHarmonics] = {{-0.0154635, 0.0147845, -0.00882118, 0.0117263, -0.00253314, -0.0119971, 0.00997113, -0.000793531}, 
{-0.0138234, 0.0147027, -0.00848713, 0.0120146, -0.00241388, -0.0120384, 0.00994844, -0.000893499}, 
{-0.0134337, 0.0146691, -0.00845168, 0.0121543, -0.00237348, -0.0121536, 0.0100516, -0.000842088}, 
{-0.0133951, 0.0145555, -0.00838122, 0.0120532, -0.00228536, -0.0121997, 0.0100812, -0.000972558}, 
{-0.0133313, 0.0138805, -0.00822724, 0.0121587, -0.00249173, -0.0123638, 0.0101009, -0.000791558}, 
{-0.0129946, 0.01408, -0.00861467, 0.0120586, -0.00245977, -0.0121223, 0.0100298, -0.000623455}, 
{-0.0131959, 0.014005, -0.0084385, 0.0123003, -0.00225582, -0.0121888, 0.00996697, -0.000794299}, 
{-0.0131462, 0.0138262, -0.00813625, 0.0120588, -0.00201689, -0.0122906, 0.00997149, -0.000710144}, 
{-0.0128264, 0.0137721, -0.00807632, 0.0118717, -0.00229613, -0.0125223, 0.0101918, -0.000656521}, 
{-0.0134245, 0.0128749, -0.00823445, 0.0116064, -0.00253184, -0.0123345, 0.0100761, 0.000272108}, 
{-0.0131388, 0.0120049, -0.00842257, 0.0113105, -0.00204993, -0.0120965, 0.00971014, 0.000123169}, 
{-0.0126655, 0.01133, -0.00809037, 0.0111381, -0.00193296, -0.0116303, 0.0101512, -4.31178e-05}, 
{-0.012277, 0.00947996, -0.00809271, 0.0111475, -0.00190399, -0.0120018, 0.00951151, -0.000206011}, 
{-0.0115772, 0.00798058, -0.00768637, 0.0100967, -0.00204672, -0.0114535, 0.00980232, 0.000680707}}; 
double meanQxTrkMinus[nCentBin][nHarmonics] = {{0.043178, 0.00618466, -0.00574171, 0.0100604, -0.0404167, 0.0469586, -0.00711839, -0.0178612}, 
{0.0439138, 0.00702396, -0.00567786, 0.00975983, -0.0403509, 0.0473052, -0.0072251, -0.0183852}, 
{0.0442554, 0.00749224, -0.00579825, 0.00956542, -0.0403703, 0.0473164, -0.00722186, -0.0184893}, 
{0.0444154, 0.00725229, -0.00588774, 0.00963661, -0.0404509, 0.0472351, -0.00720035, -0.0183603}, 
{0.044622, 0.00704801, -0.00574937, 0.0095807, -0.0406288, 0.0469171, -0.00715972, -0.0182166}, 
{0.0446286, 0.00766392, -0.00632365, 0.00965473, -0.0405059, 0.0469351, -0.00720953, -0.0179903}, 
{0.0440216, 0.00740563, -0.00570234, 0.00970172, -0.0407333, 0.0471638, -0.00719526, -0.0184761}, 
{0.0443669, 0.00720724, -0.00580469, 0.00975984, -0.0408402, 0.0468234, -0.00703998, -0.017863}, 
{0.0446943, 0.0071216, -0.00598131, 0.00986108, -0.0406693, 0.0466338, -0.00680521, -0.0178022}, 
{0.0439797, 0.00661604, -0.00592894, 0.00932297, -0.040291, 0.0463625, -0.00712088, -0.0178175}, 
{0.0430195, 0.0064584, -0.00548559, 0.00978121, -0.0395064, 0.045728, -0.00673132, -0.0176091}, 
{0.0427394, 0.00640512, -0.00525301, 0.0093021, -0.0392822, 0.044333, -0.00693756, -0.016631}, 
{0.0409025, 0.00533221, -0.00509392, 0.010032, -0.0379883, 0.0419416, -0.00638383, -0.0167458}, 
{0.0385504, 0.00623291, -0.00483522, 0.00951236, -0.0352179, 0.039585, -0.00621244, -0.0151078}}; 
double meanQyTrkMinus[nCentBin][nHarmonics] = {{-0.0354487, 0.04209, -0.0347556, 0.0362597, -0.0131216, -0.0226653, 0.0310215, -0.0137741}, 
{-0.034218, 0.0420549, -0.034647, 0.0362602, -0.0131254, -0.0224911, 0.0309387, -0.0140464}, 
{-0.0341699, 0.0422218, -0.0346944, 0.0364518, -0.0131948, -0.0226, 0.0308883, -0.013877}, 
{-0.0341124, 0.0422327, -0.0347132, 0.0363938, -0.0132006, -0.0225768, 0.0307636, -0.0138213}, 
{-0.0344739, 0.0419083, -0.0344153, 0.0365191, -0.0133198, -0.0228343, 0.0306789, -0.0136571}, 
{-0.0345149, 0.0418876, -0.0345359, 0.036525, -0.0129623, -0.0230224, 0.0304091, -0.0139445}, 
{-0.0343348, 0.0417893, -0.0346127, 0.0365088, -0.0131626, -0.022721, 0.0307669, -0.013662}, 
{-0.0340855, 0.0413784, -0.0345392, 0.036647, -0.012888, -0.0227171, 0.0306734, -0.0133523}, 
{-0.0341011, 0.0408717, -0.0346904, 0.0360093, -0.0125274, -0.02286, 0.0306357, -0.0131231}, 
{-0.0340973, 0.040472, -0.0342059, 0.0361668, -0.0126605, -0.0226931, 0.0306285, -0.0134557}, 
{-0.0332531, 0.0394852, -0.0340488, 0.0360649, -0.0130004, -0.0221344, 0.0304302, -0.0117653}, 
{-0.0327796, 0.0372031, -0.0329769, 0.0346053, -0.0121278, -0.0219964, 0.0292692, -0.0119325}, 
{-0.0309741, 0.0352016, -0.0319919, 0.0329491, -0.012877, -0.0216906, 0.0289548, -0.0105443}, 
{-0.0300457, 0.031473, -0.0298053, 0.031603, -0.0116247, -0.0200416, 0.0256277, -0.0105755}}; 
*/

