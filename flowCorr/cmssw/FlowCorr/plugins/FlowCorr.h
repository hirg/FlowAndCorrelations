#include "TComplex.h"
#include <vector>
#include <TVector3.h>

#define nCentBin 13
#define nHarmonics 8
#define nPtBin 14 

using namespace std;
using namespace reco;
using namespace edm;

  bool useRe = true;
  double cBin[nCentBin+1]={0,5,10,15,20,25,30,35,40,50,60,70,80,100};
  double ptBin[nPtBin+1]={0.3, 0.4, 0.5, 0.6, 0.8, 1.0, 1.2, 1.6, 2.0, 2.5, 3.0, 4.0, 6.0, 8.0, 12.0};
  TComplex QhfPlus[nCentBin][nHarmonics];
  TComplex QhfMinus[nCentBin][nHarmonics];
  //TComplex QtrkPlus[nCentBin][nHarmonics];
  //TComplex QtrkMinus[nCentBin][nHarmonics];
  double VnAbs2[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs4[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs6[nCentBin][nHarmonics]={{0.0},{0.0}};
  double V2Abs2V3Abs2[nCentBin]={0.0};
  double V2Abs4V3Abs2[nCentBin]={0.0};
  double V4V2starV2star[nCentBin]={0.0};
  double V6V2starV2starV2star[nCentBin]={0.0};
  double V6V3starV3star[nCentBin]={0.0};
  double V5V2starV3star[nCentBin]={0.0};
  double V7V2starV2starV3star[nCentBin]={0.0};
  double v2Psi2[nCentBin]={0.0};
  double v3Psi3[nCentBin]={0.0};
  double v4Psi2[nCentBin]={0.0};
  double v4Psi4[nCentBin]={0.0};
  double v6Psi2[nCentBin]={0.0};
  double v6Psi3[nCentBin]={0.0};
  double v6Psi6[nCentBin]={0.0};
  double v5Psi2Psi3[nCentBin]={0.0};
  double v7Psi2Psi3[nCentBin]={0.0};
  int nEvent[nCentBin]={0};

  vector<TVector3> *pVect_trkEtaPlus;
  vector<TVector3> *pVect_trkEtaMinus;  
  vector<TVector3> *pVect_hfEtaPlus;
  vector<TVector3> *pVect_hfEtaMinus;  

  TH1D* hMultTrkEtaPlus;
  TH1D* hMultTrkEtaMinus;
  TH1D* hMultHFEtaPlus;
  TH1D* hMultHFEtaMinus;
  TH1D* hQhfPlusX[nCentBin][nHarmonics];
  TH1D* hQhfPlusY[nCentBin][nHarmonics];
  TH1D* hQhfPlusQ[nCentBin][nHarmonics];
  TH1D* hQhfMinusX[nCentBin][nHarmonics];
  TH1D* hQhfMinusY[nCentBin][nHarmonics];
  TH1D* hQhfMinusQ[nCentBin][nHarmonics];
  TH1D* hVnAbs2[nCentBin][nHarmonics];
  TH1D* hVnAbs4[nCentBin][nHarmonics];
  TH1D* hVnAbs6[nCentBin][nHarmonics];
  TH1D* hV2Abs2V3Abs2[nCentBin];
  TH1D* hV2Abs4V3Abs2[nCentBin];

  TH1D* hV2V2star[nCentBin];
  TH1D* hV4V2starV2star[nCentBin];
  TH1D* hV6V2starV2starV2star[nCentBin];
  TH1D* hV6V3starV3star[nCentBin];
  TH1D* hV5V2starV3star[nCentBin];
  TH1D* hV7V2starV2starV3star[nCentBin];

  TH1D* hv2V2star[nCentBin][nPtBin];
  TH1D* hv4V2starV2star[nCentBin][nPtBin];
  TH1D* hv6V2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv6V3starV3star[nCentBin][nPtBin];
  TH1D* hv5V2starV3star[nCentBin][nPtBin];
  TH1D* hv7V2starV2starV3star[nCentBin][nPtBin];



   TH1D* hCent;
   TH1D* hHF;
   TH1D* hAngle;
   TH1D* hAngleFlat;
   TH1D* hvz;
   TH1D* hvx;
   TH1D* hvy;
   TH1D* hNtrks;
   TH1D* hpt;
   TH1D* heta;
   TH1D* hphi;
   TH1D* hHFcal;


double meanQxPlus[nCentBin][nHarmonics] = {{0.0127464, 0.0246683, -0.0136076, -0.0101542, -0.00787133, 0.021193, 0.00483549, -0.0261214}, 
{0.0137722, 0.0252117, -0.0132663, -0.00985514, -0.00771759, 0.0212282, 0.00466083, -0.0263814}, 
{0.0143008, 0.0251674, -0.0134132, -0.0101788, -0.00772212, 0.0214621, 0.00470186, -0.0264902}, 
{0.0145193, 0.0254238, -0.0131424, -0.010101, -0.00775569, 0.0215813, 0.00443978, -0.0265744}, 
{0.0147921, 0.0250831, -0.0134042, -0.0101721, -0.00779566, 0.0214069, 0.00447886, -0.0267473}, 
{0.0151977, 0.0255654, -0.0131051, -0.0102943, -0.00779723, 0.0217613, 0.00454374, -0.0266944}, 
{0.0154887, 0.0257533, -0.0129876, -0.0101416, -0.00797694, 0.0216198, 0.00438113, -0.0267294}, 
{0.0160585, 0.0264798, -0.0128854, -0.0101185, -0.00809521, 0.0219212, 0.00409687, -0.0269148}, 
{0.0167701, 0.0256494, -0.0125724, -0.00995888, -0.00792721, 0.0215266, 0.00424992, -0.0264435}, 
{0.0159569, 0.0263015, -0.0125888, -0.0100669, -0.00846108, 0.0218244, 0.00406856, -0.0270059}, 
{0.0156718, 0.0275581, -0.0130978, -0.00954312, -0.0080949, 0.0220246, 0.00405112, -0.0267698}, 
{0.0167264, 0.027082, -0.0127867, -0.00964468, -0.00853408, 0.0219468, 0.00425237, -0.0275801}, 
{0.0158754, 0.0233639, -0.0112107, -0.00766875, -0.00650619, 0.0170177, 0.00366818, -0.0233952}}; 
double meanQyPlus[nCentBin][nHarmonics] = {{-0.0130036, 0.0124905, -0.00644967, 0.00224756, -0.00112361, -0.00677836, 0.00472413, -0.00858605}, 
{-0.0117861, 0.0124252, -0.00604326, 0.00240764, -0.000894718, -0.00659301, 0.0047947, -0.00914915}, 
{-0.0110702, 0.0125166, -0.00604848, 0.00250552, -0.00106816, -0.00652999, 0.00465159, -0.00917355}, 
{-0.0105703, 0.0130076, -0.00593657, 0.00244607, -0.0010279, -0.0065511, 0.00467277, -0.00934955}, 
{-0.0103197, 0.0127952, -0.00565907, 0.00251127, -0.00119122, -0.0064371, 0.0043449, -0.00929014}, 
{-0.0098737, 0.0123754, -0.00583251, 0.00253235, -0.0011267, -0.00624465, 0.00440286, -0.00928564}, 
{-0.00970156, 0.0127423, -0.00598454, 0.0026261, -0.00122143, -0.00642823, 0.00460196, -0.00933551}, 
{-0.0088456, 0.0122022, -0.00593258, 0.00243712, -0.00136684, -0.00665804, 0.00441137, -0.0094302}, 
{-0.00862914, 0.0123982, -0.00582335, 0.00263725, -0.0013346, -0.0067164, 0.00441985, -0.00932809}, 
{-0.00823564, 0.0117627, -0.00556978, 0.00302126, -0.00134387, -0.00662229, 0.00446182, -0.00968665}, 
{-0.00801886, 0.0106847, -0.00507898, 0.0024198, -0.00147911, -0.00639545, 0.00448294, -0.00996861}, 
{-0.00735086, 0.0102387, -0.00540355, 0.00289056, -0.000399933, -0.00754659, 0.0046321, -0.00953495}, 
{-0.00743005, 0.00167504, -0.00578931, 0.0028344, 0.000602584, -0.00758696, 0.00572857, -0.00782386}}; 
double meanQxMinus[nCentBin][nHarmonics] = {{0.0436115, 0.00951033, -0.00913859, 0.00878498, -0.0404994, 0.0550195, -0.0117498, -0.0180173}, 
{0.0441037, 0.00956957, -0.00954909, 0.00893233, -0.0401692, 0.0551834, -0.0118058, -0.018257}, 
{0.0439001, 0.00937928, -0.00922738, 0.00877407, -0.0399856, 0.0549508, -0.0117074, -0.0184199}, 
{0.0441457, 0.00964305, -0.00911316, 0.00867194, -0.0398751, 0.0549583, -0.0118319, -0.0186102}, 
{0.0441546, 0.00920568, -0.00934505, 0.00861724, -0.0397214, 0.0550045, -0.0116819, -0.0185068}, 
{0.0440418, 0.0100696, -0.00909961, 0.0086117, -0.0397664, 0.0550143, -0.0119017, -0.0188348}, 
{0.0444578, 0.00984855, -0.00871474, 0.00848909, -0.0400606, 0.0552336, -0.0120252, -0.0189203}, 
{0.044895, 0.0106545, -0.00900683, 0.00860311, -0.0402292, 0.0556276, -0.0119315, -0.0192626}, 
{0.0456497, 0.00953267, -0.00864076, 0.00872488, -0.0398169, 0.0556347, -0.0122338, -0.0196091}, 
{0.0446342, 0.00981837, -0.0091987, 0.0086329, -0.040134, 0.0560422, -0.0121398, -0.01956}, 
{0.0448754, 0.0103758, -0.00827876, 0.00848972, -0.0411437, 0.056072, -0.0126756, -0.0199708}, 
{0.0460032, 0.0097956, -0.0104088, 0.00991445, -0.0404912, 0.0567118, -0.0120615, -0.0195969}, 
{0.0413225, 0.00760032, -0.00740846, 0.00970915, -0.0388341, 0.0492569, -0.010922, -0.0172397}}; 
double meanQyMinus[nCentBin][nHarmonics] = {{-0.0364262, 0.0456513, -0.0408877, 0.0336412, -0.0128833, -0.0189651, 0.0306468, -0.0252582}, 
{-0.035196, 0.0454638, -0.0407974, 0.0333346, -0.0126529, -0.0186646, 0.030337, -0.0259781}, 
{-0.0346743, 0.0457718, -0.0406844, 0.0330451, -0.0126137, -0.0183495, 0.0302732, -0.0260082}, 
{-0.0340466, 0.0455928, -0.0407003, 0.0329749, -0.0127309, -0.0182288, 0.0302722, -0.0261953}, 
{-0.0338709, 0.0455479, -0.0406687, 0.0329983, -0.0127932, -0.0180926, 0.0300589, -0.0260997}, 
{-0.0335693, 0.0453406, -0.0406098, 0.0332191, -0.0129297, -0.0180232, 0.0298994, -0.0263636}, 
{-0.0330828, 0.0459131, -0.0402037, 0.0329527, -0.0126194, -0.0183729, 0.0298405, -0.0263496}, 
{-0.0330123, 0.0453545, -0.0401786, 0.0330891, -0.0126874, -0.0180059, 0.0298777, -0.0265125}, 
{-0.03225, 0.0458585, -0.0407747, 0.0327863, -0.0130203, -0.0182438, 0.0301053, -0.0267263}, 
{-0.032264, 0.0457851, -0.0402649, 0.0327525, -0.0128423, -0.018105, 0.0300724, -0.0265675}, 
{-0.0324435, 0.0458835, -0.0403249, 0.0332052, -0.0132283, -0.0181269, 0.0304053, -0.0267012}, 
{-0.0331795, 0.0459737, -0.0402834, 0.0334319, -0.0129523, -0.017927, 0.0310029, -0.0277856}, 
{-0.0297874, 0.0338771, -0.0369121, 0.0301656, -0.0114135, -0.0177717, 0.0281724, -0.0233323}};


