#include "TComplex.h"
#include <vector>
#include <TVector3.h>

#define nCentBin 14
#define nHarmonics 8
#define nPtBin 19 

using namespace std;
using namespace reco;
using namespace edm;

  bool useReDenominator = true;
  bool useRe = true;
  double cBin[nCentBin+1]={0,5,10,15,20,25,30,35,40,50,60,70,80,90,100};
  double ptBin[nPtBin+1]={0.3, 0.4, 0.5, 0.6, 0.8, 1.0, 1.2, 1.6, 2.0, 2.5, 3.0, 3.5, 4.0, 5.0, 6.0, 8.0, 10.0, 12.0, 16.0, 22.0};
  TComplex QhfPlus[nCentBin][nHarmonics];
  TComplex QhfMinus[nCentBin][nHarmonics];
  //TComplex QtrkPlus[nCentBin][nHarmonics];
  //TComplex QtrkMinus[nCentBin][nHarmonics];
  double VnAbs2[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs4[nCentBin][nHarmonics]={{0.0},{0.0}};
  double VnAbs6[nCentBin][nHarmonics]={{0.0},{0.0}};
  double V2Abs2V3Abs2[nCentBin]={0.0};
  double V2Abs4V3Abs2[nCentBin]={0.0};
  double V4V2starV2star[nCentBin]={0.0};
  double V6V2starV2starV2star[nCentBin]={0.0};
  double V6V3starV3star[nCentBin]={0.0};
  double V5V2starV3star[nCentBin]={0.0};
  double V7V2starV2starV3star[nCentBin]={0.0};
  double v2Psi2[nCentBin]={0.0};
  double v3Psi3[nCentBin]={0.0};
  double v4Psi2[nCentBin]={0.0};
  double v4Psi4[nCentBin]={0.0};
  double v6Psi2[nCentBin]={0.0};
  double v6Psi3[nCentBin]={0.0};
  double v6Psi6[nCentBin]={0.0};
  double v5Psi2Psi3[nCentBin]={0.0};
  double v7Psi2Psi3[nCentBin]={0.0};
  int nEvent[nCentBin]={0};

  vector<TVector3> *pVect_trkEtaPlus;
  vector<TVector3> *pVect_trkEtaMinus;  
  vector<TVector3> *pVect_hfEtaPlus;
  vector<TVector3> *pVect_hfEtaMinus;  

  TH1D* hMultTrkEtaPlus;
  TH1D* hMultTrkEtaMinus;
  TH1D* hMultHFEtaPlus;
  TH1D* hMultHFEtaMinus;
  TH1D* hQhfPlusX[nCentBin][nHarmonics];
  TH1D* hQhfPlusY[nCentBin][nHarmonics];
  TH1D* hQhfPlusQ[nCentBin][nHarmonics];
  TH1D* hQhfMinusX[nCentBin][nHarmonics];
  TH1D* hQhfMinusY[nCentBin][nHarmonics];
  TH1D* hQhfMinusQ[nCentBin][nHarmonics];
  TH1D* hVnAbs2[nCentBin][nHarmonics];
  TH1D* hVnAbs4[nCentBin][nHarmonics];
  TH1D* hVnAbs6[nCentBin][nHarmonics];
  TH1D* hVnAbs8[nCentBin][nHarmonics];
  TH1D* hV2Abs2V3Abs2[nCentBin];
  TH1D* hV2Abs4V3Abs2[nCentBin];
  TH1D* hV2Abs2V3Abs4[nCentBin];


  TH1D* hV2V2star[nCentBin];
  TH1D* hV4V2starV2star[nCentBin];
  TH1D* hV6V2starV2starV2star[nCentBin];
  TH1D* hV6V3starV3star[nCentBin];
  TH1D* hV5V2starV3star[nCentBin];
  TH1D* hV7V2starV2starV3star[nCentBin];

  TH1D* hv2V2star[nCentBin][nPtBin];
  TH1D* hv3V3star[nCentBin][nPtBin];
  TH1D* hv4V4star[nCentBin][nPtBin];
  TH1D* hv5V5star[nCentBin][nPtBin];
  TH1D* hv6V6star[nCentBin][nPtBin];
  TH1D* hv7V7star[nCentBin][nPtBin];
  TH1D* hv8V8star[nCentBin][nPtBin];
  TH1D* hv4V2starV2star[nCentBin][nPtBin];
  TH1D* hv6V2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv6V3starV3star[nCentBin][nPtBin];
  TH1D* hv5V2starV3star[nCentBin][nPtBin];
  TH1D* hv7V2starV2starV3star[nCentBin][nPtBin];
  TH1D* hv8V2starV2starV2starV2star[nCentBin][nPtBin];
  TH1D* hv8V2starV3starV3star[nCentBin][nPtBin];

  TH1D* hMeanPt[nCentBin][nPtBin];


   TH1D* hCent;
   TH1D* hHF;
   TH1D* hAngle;
   TH1D* hAngleFlat;
   TH1D* hvz;
   TH1D* hvx;
   TH1D* hvy;
   TH1D* hNtrks;
   TH1D* hpt;
   TH1D* heta;
   TH1D* hphi;
   TH1D* hHFcal;



double meanQxPlus[nCentBin][nHarmonics] = {{0.00824833, -0.00236947, 0.00335713, -0.00403562, 0.00142359, -0.001301, 0.00346111, 0.00068791}, 
{0.00821029, -0.00228213, 0.00350066, -0.00392637, 0.00141958, -0.00126462, 0.0035362, 0.000633592}, 
{0.00802276, -0.00241176, 0.0035966, -0.00408073, 0.00123928, -0.00122769, 0.00354257, 0.000703874}, 
{0.00773438, -0.00228969, 0.00334171, -0.00393998, 0.00118523, -0.00107636, 0.00342255, 0.000958998}, 
{0.00754846, -0.00248176, 0.0032978, -0.00392829, 0.000966474, -0.000920429, 0.00319077, 0.00118513}, 
{0.00714904, -0.00214128, 0.00308647, -0.00380557, 0.000807685, -0.000975874, 0.00312457, 0.0013532}, 
{0.00689748, -0.00210848, 0.00307055, -0.00372566, 0.000669409, -0.000977134, 0.00300222, 0.00151001}, 
{0.00678637, -0.00152763, 0.00291137, -0.0037228, 0.000457551, -0.000817231, 0.00281596, 0.00172733}, 
{0.00662404, -0.00216351, 0.0027927, -0.00363909, 0.000427582, -0.000875921, 0.00274811, 0.00177658}, 
{0.00571885, -0.00217236, 0.0028009, -0.00364397, 0.000166165, -0.000834442, 0.002813, 0.00206946}, 
{0.00350902, -0.0018458, 0.00251955, -0.0038811, -0.000226141, -0.00048523, 0.00300115, 0.00222721}, 
{-0.00249881, -0.00203575, 0.00176769, -0.00412301, -0.000481252, -0.000745376, 0.00430601, 0.00317815}, 
{-0.0185414, -0.00144332, 0.000370868, -0.00457849, -0.00193182, -0.000739198, 0.00722683, 0.00556783}, 
{-0.0539541, -0.00230546, -0.00451931, -0.00778049, -0.00471071, -0.00212759, 0.0144412, 0.0134849}}; 
double meanQyPlus[nCentBin][nHarmonics] = {{0.000857938, 0.00338646, 0.000115286, -0.000901413, -0.000485904, 0.00164421, 4.72499e-05, -0.00124632}, 
{0.000779464, 0.0032684, 1.34673e-05, -0.000962374, -0.00047011, 0.0017116, -3.4983e-05, -0.00124227}, 
{0.000786354, 0.00352814, -9.72025e-05, -0.000897697, -0.000535689, 0.00173187, 3.34399e-05, -0.00132196}, 
{0.000812055, 0.00369615, -8.89936e-05, -0.000911742, -0.000513614, 0.00175701, 2.89048e-05, -0.00129918}, 
{0.000870114, 0.00356355, -9.69833e-05, -0.000744549, -0.000760101, 0.00188453, -4.86206e-05, -0.00124191}, 
{0.000923953, 0.0035187, -5.12807e-05, -0.000762515, -0.000766443, 0.00189541, -7.24971e-05, -0.00125759}, 
{0.000877375, 0.0037864, -0.000151504, -0.000492841, -0.000785649, 0.001845, -7.95192e-05, -0.00116615}, 
{0.000930466, 0.00329656, -0.000218555, -0.000555887, -0.000811868, 0.00189786, 7.6374e-06, -0.0011934}, 
{0.00094919, 0.00329665, -0.000109481, -0.000581076, -0.000951199, 0.00195289, -4.21347e-06, -0.00122462}, 
{0.00101539, 0.00347543, -0.000468627, -0.000252029, -0.00101408, 0.00195045, -5.44938e-05, -0.00120802}, 
{0.00153214, 0.00399457, -0.000925042, 0.00039081, -0.00152281, 0.0022873, 0.000110043, -0.00150004}, 
{0.00253356, 0.00486988, -0.00299842, 0.00321227, -0.00221394, 0.0025852, -0.000134792, -0.0015971}, 
{0.0048224, 0.0066436, -0.00817117, 0.0102075, -0.00517397, 0.0033169, -5.78071e-05, -0.0034109}, 
{0.00856721, 0.013229, -0.0218711, 0.0289875, -0.0131197, 0.00799705, -0.00136432, -0.00647519}}; 
double meanQxMinus[nCentBin][nHarmonics] = {{0.000367219, -0.000397174, -0.00255337, 0.00183179, 0.00497764, 0.00144209, -0.000994911, 0.0033725}, 
{0.000346113, -0.000571465, -0.00261682, 0.00194131, 0.00496878, 0.00144485, -0.000991693, 0.00336488}, 
{0.000395516, -0.000981525, -0.00250268, 0.00180385, 0.00486626, 0.0013312, -0.0010358, 0.0032747}, 
{0.000227241, -0.000654896, -0.00248659, 0.00186866, 0.00479968, 0.00114434, -0.00118264, 0.00336408}, 
{0.000360549, -0.000955938, -0.0025635, 0.00193814, 0.00476303, 0.0011124, -0.00133188, 0.00322005}, 
{0.000570247, -0.000975898, -0.00229824, 0.00197972, 0.0047806, 0.00101403, -0.00145721, 0.00327247}, 
{0.000659253, -0.000757148, -0.00232056, 0.00181594, 0.00471779, 0.000871582, -0.00160775, 0.00328985}, 
{0.000377154, -0.000550933, -0.0025323, 0.00171789, 0.00465981, 0.000899673, -0.00161963, 0.00318383}, 
{0.000582257, -0.00125, -0.00238457, 0.00166672, 0.00470524, 0.000857493, -0.00159119, 0.00313475}, 
{0.000892745, -0.00128498, -0.00237843, 0.0015112, 0.00460964, 0.000983568, -0.00169124, 0.00305068}, 
{0.00121043, -0.00119431, -0.00252528, 0.00207852, 0.00502906, 0.000555504, -0.00239929, 0.00244802}, 
{0.00259327, -0.000633249, -0.00243798, 0.00310764, 0.00517366, -0.000885786, -0.00407438, 0.000877507}, 
{0.00603539, -0.00113208, -0.0021497, 0.00480009, 0.0058925, -0.00500923, -0.00879572, -0.00415926}, 
{0.0171455, 0.00109279, -0.00258077, 0.0100035, 0.00727012, -0.0162147, -0.0212322, -0.0163921}}; 
double meanQyMinus[nCentBin][nHarmonics] = {{0.00651665, 0.00786758, -0.00250867, -0.00474758, -6.71322e-05, 0.00108802, 0.000215638, -0.000556745}, 
{0.00652825, 0.00778592, -0.00249611, -0.004652, -0.000219666, 0.00113045, 0.00021278, -0.000514509}, 
{0.00650818, 0.00782366, -0.00239234, -0.0048233, -0.000194297, 0.00112278, 0.00021063, -0.000497336}, 
{0.00647379, 0.00794101, -0.00240821, -0.00472245, -0.00039718, 0.00118709, 0.000214937, -0.000489877}, 
{0.00645196, 0.0078598, -0.0022868, -0.00470895, -0.000395135, 0.00114321, 0.000231652, -0.000489639}, 
{0.00636707, 0.0077048, -0.00220966, -0.00464338, -0.000559086, 0.00132725, 0.00015884, -0.000392582}, 
{0.00616601, 0.00819467, -0.00205986, -0.00467805, -0.000544098, 0.00127527, 0.000267943, -0.000359518}, 
{0.00601772, 0.00769112, -0.0020266, -0.00460173, -0.000540783, 0.00131458, 0.000397385, -0.000475243}, 
{0.00593771, 0.00798199, -0.0020648, -0.00438915, -0.000561857, 0.0013514, 0.000439278, -0.000641419}, 
{0.00601604, 0.00807244, -0.00193562, -0.0042956, -0.000808059, 0.00123419, 0.000798081, -0.000564521}, 
{0.00541438, 0.00773704, -0.00194138, -0.00390992, -0.000924491, 0.00136386, 0.00173097, -0.000415917}, 
{0.00443285, 0.00692071, -0.00134317, -0.00258096, -0.00154348, 0.00193318, 0.00378706, 0.000425856}, 
{0.000873884, 0.00458446, 0.000804558, 0.000269244, -0.00413829, 0.00317331, 0.0107046, 0.00373832}, 
{-0.0091525, -0.00168598, 0.00414904, 0.0074608, -0.00950774, 0.00699813, 0.0282415, 0.0107964}}; 



